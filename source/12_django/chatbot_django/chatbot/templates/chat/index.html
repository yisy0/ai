{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’° ì†Œë“ì„¸ ì±—ë´‡</title>

    <!-- ìŠ¤íƒ€ì¼ ì •ì˜ -->
    <link href="{% static 'css/chat.css' %}" rel="stylesheet">
</head>
<body>
    <!-- í—¤ë” -->
    <div class="header">
        <h1>ğŸ’° ì†Œë“ì„¸ ì±—ë´‡</h1>
        <p>ì†Œë“ì„¸ ì±—ë´‡ì„ ì‚¬ìš©í•˜ì—¬ ì§ˆë¬¸ì— ë‹µë³€í•˜ê³  ì°¸ì¡° ì¡°í•­ì„ í•¨ê»˜ ë°˜í™˜í•©ë‹ˆë‹¤.</p>
    </div>
    
    <!-- ì±„íŒ… ì˜ì—­ -->
    <div class="chat-container" id="chatContainer">
        <!-- ê¸°ì¡´ ëŒ€í™” ë‚´ì—­ í‘œì‹œ -->
        {% if not messages %}
        <div class="loading-message">
            ğŸ’¬ ì†Œë“ì„¸ì— ê´€ë ¨ëœ ì§ˆë¬¸ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!
        </div>
        {% endif %}
        
        {% for msg in messages %}
            {% if msg.role == 'user' %}
                <div class="message user-message">{{ msg.content }}</div>
            {% else %}
                <div class="message ai-message">{{ msg.content }}</div>
            {% endif %}
        {% endfor %}
    </div>
    
    <!-- ì…ë ¥ ì˜ì—­ (í¼ ë°©ì‹) -->
    <div class="input-container">
        <form method="POST" action="{% url 'chat:index' %}" class="input-form" onsubmit="showLoading()">
            {% csrf_token %}
            <input 
                type="text" 
                name="question"
                id="questionInput" 
                placeholder="ì†Œë“ì„¸ì— ê´€ë ¨ ì§ˆë¬¸ì„ ë¬¼ì–´ë³´ì„¸ìš”"
                required
                autocomplete="off"
                autofocus
            >
            <button type="submit" class="submit-btn">ì „ì†¡</button>
        </form>
    </div>
    
    <!-- ìµœì†Œí•œì˜ JavaScript (í¼ ì œì¶œ ì‹œ ë¡œë”© í‘œì‹œë§Œ) -->
    <script>
        // í¼ ì œì¶œ ì‹œ ë¡œë”© í‘œì‹œ
        function showLoading() {
            const container = document.getElementById('chatContainer');
            const loadingDiv = document.createElement('div');
            loadingDiv.className = 'loading-message';
            loadingDiv.innerHTML = 'â³ ì§ˆë¬¸ì— ë‹µë³€ì„ ìƒì„±í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤...';
            container.appendChild(loadingDiv);
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìŠ¤í¬ë¡¤ì„ ë§¨ ì•„ë˜ë¡œ
        // â­ ìŠ¤í¬ë¡¤ í•¨ìˆ˜
        function scrollToBottom() {
            const container = document.getElementById('chatContainer');
            container.scrollTop = container.scrollHeight;
        }
        window.onload = function() {
            const container = document.getElementById('chatContainer');
            container.scrollTop = container.scrollHeight - 300;
            //â†’ 550px ì •ë„ ëœ ìŠ¤í¬ë¡¤ = ë‹µë³€ ëë¶€ë¶„ì´ ì ë‹¹íˆ ë³´ì„
        }
    </script>
</body>
</html>
